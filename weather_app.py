# -*- coding: utf-8 -*-
"""Weather_app.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1TeTdCBvtpwda9f0PGjwiR7w7GB7_3sUD
"""

import streamlit as st
import requests
import matplotlib.pyplot as plt

# ğŸŒ¤ ì•± ê¸°ë³¸ ì„¤ì •
st.set_page_config(page_title="Weather API App", page_icon="ğŸŒ¦ï¸", layout="centered")

st.title("ğŸŒ¦ï¸ ì‹¤ì‹œê°„ ë‚ ì”¨ Open API ì•±")
st.caption("Powered by OpenWeather API")

# ğŸ”¹ ë„ì‹œ ì…ë ¥
city = st.text_input("ë„ì‹œ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: Seoul, Busan, Tokyo)", "Seoul")

# ğŸ”¹ API í‚¤ ì§ì ‘ ì…ë ¥ (ì„ ì¬ì˜ í‚¤ í¬í•¨)
API_KEY = "8c6f2cd4a90213d6649576e1c83e06f3"

# ğŸ”¹ ë²„íŠ¼ í´ë¦­ ì‹œ ì‹¤í–‰
if st.button("ë‚ ì”¨ ë¶ˆëŸ¬ì˜¤ê¸°"):
    url = f"http://api.openweathermap.org/data/2.5/weather?q={city}&appid={API_KEY}&units=metric"
    response = requests.get(url)

    if response.status_code == 200:
        data = response.json()
        temp = data['main']['temp']
        feels_like = data['main']['feels_like']
        humidity = data['main']['humidity']
        weather = data['weather'][0]['description']
        icon = data['weather'][0]['icon']

        # ê²°ê³¼ í‘œì‹œ
        st.subheader(f"ğŸ“ {city}ì˜ ë‚ ì”¨ ì •ë³´")
        st.image(f"http://openweathermap.org/img/wn/{icon}@2x.png")
        st.metric(label="ê¸°ì˜¨ (Â°C)", value=f"{temp:.1f}")
        st.metric(label="ì²´ê°ì˜¨ë„ (Â°C)", value=f"{feels_like:.1f}")
        st.metric(label="ìŠµë„ (%)", value=f"{humidity}")

        # ê·¸ë˜í”„ ì‹œê°í™”
        st.subheader("ğŸŒ¡ ê¸°ì˜¨ ë° ìŠµë„ ë¹„êµ")
        fig, ax = plt.subplots()
        ax.bar(['Temperature', 'Feels Like', 'Humidity'],
               [temp, feels_like, humidity],
               color=['#FFB6C1', '#87CEFA', '#98FB98'])
        ax.set_ylabel("Value")
        ax.set_title(f"Weather Data for {city}")
        st.pyplot(fig)

    else:
        st.error(f"âŒ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. (Error code: {response.status_code})")
        st.write("ğŸ” ìƒíƒœ ì½”ë“œ:", response.status_code)
        st.write("ğŸ§¾ ì‘ë‹µ ë‚´ìš©:", response.text)